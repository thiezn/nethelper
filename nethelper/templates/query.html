{% extends "base.html" %}

{% block content %}
<h1>NetHelper</h1>

<p>
Check <a href="https://developers.google.com/web/fundamentals/design-and-ui/responsive/">this</a> site for some UI improvements<br>
Check <a href="https://developers.google.com/web/fundamentals/design-and-ui/input/forms/">this</a> Common regular expression patterns section for parsing ip addresses using regexes
</p>

<div class="box">
    <p>Please provide a network, mac address or port number</p>
    <form action="/" method="get" accept-charset="utf-8">
        <input id="query" name="network" placeholder="eg. 10.0.0.0/24" {% if network %}value="{{ network.network }}/{{ network.bitmask }}"{% endif %}></input>
        <input type="submit" value="network" /> <!--[if lt IE 10]><small>examples: '10.0.0.0/24', '10.0.0.0 255.255.255.0'</small><![endif]-->
    </form>

    <form action="/" method="get" accept-charset="utf-8">
        <input id="query" name="mac" placeholder="eg. '0011.2233.4455'" {% if mac %}value="{{ mac.mac_address }}"{% endif %}></input>
        <input type="submit" value="mac" /> <!--[if lt IE 10]><small>examples: '0011.2233.4455', '00:11:22:33:44:55' or '00-11-22-33-44-55'</small><![endif]-->
    </form>

    <form action="/" method="get" accept-charset="utf-8">
        <input id="query" name="port" placeholder="eg. tcp/22, 8080" {% if port %}value="{{ port.protocol }}/{{ port.port }}"{% endif %}></input>
        <input type="submit" value="port" /> <!--[if lt IE 10]><small>examples: tcp/22, udp/21 or 8080</small><![endif]-->
    </form>
</div>

{% if network or port or mac %}
<div class="box">
    {% if network %}
        <table>
            <caption>Network Details</caption>
            <thead>
                <tr>
                    <th scope='col'>network</th>
                    <th scope='col'>netmask</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td data-label="network">{{ network.network }}</td>
                    <td data-label="netmask">{{ network.netmask }}</td>
                    <td data-label="bitmask">{{ network.bitmask }}</td>
                    <td data-label="hostmask">{{ network.hostmask }}</td>
                    <td data-label="first_host">{{ network.first_host }}</td>
                    <td data-label="last_host">{{ network.last_host }}</td>
                    <td data-label="num_addresses">{{ network.num_addresses }}</td>
                    <td data-label="broadcast">{{ network.broadcast }}</td>
                    <td data-label="is_private">{{ network.is_private }}</td>
                    <td data-label="is_multicast">{{ network.is_multicast }}</td>
                </tr>
            </tbody>
        </table>
    {% endif %}

    {% if port %}
       <table>
            <caption>Port Details</caption>
            <thead>
                <tr>
                    <th scope='col'>number</th>
                    <th scope='col'>name</th>
                    <th scope='col'>description</th>
                    <th scope='col'>assignee</th>
                    <th scope='col'>contact</th>
                    <th scope='col'>registration date</th>
                    <th scope='col'>modification date</th>
                    <th scope='col'>reference</th>
                    <th scope='col'>service code</th>
                    <th scope='col'>known unauthorized uses</th>
                    <th scope='col'>assignment notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td data-label="port number">{{ port.port }}</td>
                    <td data-label="name">{{ port.name }}</td>
                    <td data-label="description">{{ port.description }}</td>
                    <td data-label="assignee">{{ port.assignee }}</td>
                    <td data-label="contact">{{ port.contact }}</td>
                    <td data-label="registration_date">{{ port.registation_date }}</td>
                    <td data-label="modification_date">{{ port.modification_date }}</td>
                    <td data-label="reference">{{ port.reference }}</td>
                    <td data-label="service_code">{{ port.service_code }}</td>
                    <td data-label="known_unauthorized_uses">{{ port.known_unauthorized_uses }}</td>
                    <td data-label="assignment_notes">{{ port.assignment_notes }}</td>
                </tr>
            </tbody>
        </table>
    {% endif %}

    {% if mac %}
       <table>
            <caption>Port Details</caption>
            <thead>
                <tr>
                    <th scope='col'>mac address</th>
                    <th scope='col'>mac address dots</th>
                    <th scope='col'>mac address dashes</th>
                    <th scope='col'>mac address flat</th>
                    <th scope='col'>mac address binary</th>
                    <th scope='col'>vendor ID</th>
                    <th scope='col'>vendor(s)</th>
                    <th scope='col'>is unicast</th>
                    <th scope='col'>is multicast</th>
                    <th scope='col'>is universal</th>
                    <th scope='col'>is local</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td data-label="mac_address">{{ mac.mac_address }}</td>
                    <td data-label="mac_address_dots">{{ mac.mac_address_dots }}</td>
                    <td data-label="mac_address_dashes">{{ mac.mac_address_dashes }}</td>
                    <td data-label="mac_address_flat">{{ mac.mac_address_flat }}</td>
                    <td data-label="mac_address_binary">{{ mac.mac_address_binary }}</td>
                    <td data-label="vendor_id">{{ mac.vendor_id }}</td>
                    <td data-label="vendor(s)
                    {% for vendor in mac.vendors %}
                       ">{{ vendor }}
                       ">{{ "," if not loop.last }}
                    {% endfor %}   
                    </td>
                    <td data-label="is_unicast">{{ mac.is_unicast }}</td>
                    <td data-label="is_multicast">{{ mac.is_multicast }}</td>
                    <td data-label="is_universal">{{ mac.is_universal }}</td>
                    <td data-label="is_local">{{ mac.is_local }}</td>
                </tr>
            </tbody>
        </table>
    {% endif %}
</div>
{% endif %}

<div class="box">
  <h2>Client details <small>thats you...</small></h2>
  <ul>
    <li><b>IP</b>>{{ client_ip }}</li>
    <li><b>Src port</b>>{{ client_port }}</lo>
    {% for key, value in client_headers.items() %}
      <li><b>{{ key }}:</b>    {{ value }}</li>
    {% endfor %}
  </ul>
</div>

{% endblock content %}
